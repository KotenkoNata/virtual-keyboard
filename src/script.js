const keyLayout = [
  [
    {
      code: 'Backquote',
      layouts: {
        rus: 'ё',
        en: '`',
      },
    },
    {
      code: 'Digit1',
      layouts: {
        rus: '!',
        en: '1',
      },
    },
    {
      code: 'Digit2',
      layouts: {
        rus: '"',
        en: '2',
      },
    },
    {
      code: 'Digit3',
      layouts: {
        rus: '№',
        en: '3',
      },
    },
    {
      code: 'Digit4',
      layouts: {
        rus: ';',
        en: '4',
      },
    }, {
    code: 'Digit5',
    layouts: {
      rus: '%',
      en: '5',
    },
  }, {
    code: 'Digit6',
    layouts: {
      rus: ':',
      en: '6',
    },
  }, {
    code: 'Digit7',
    layouts: {
      rus: '?',
      en: '7',
    },
  }, {
    code: 'Digit8',
    layouts: {
      rus: '*',
      en: '8',
    },
  }, {
    code: 'Digit9',
    layouts: {
      rus: '(',
      en: '9',
    },
  }, {
    code: 'Digit0',
    layouts: {
      rus: ')',
      en: '0',
    },
  }, {
    code: 'Minus',
    layouts: {
      rus: '_',
      en: '-',
    },
  }, {
    code: 'Equal',
    layouts: {
      rus: '+',
      en: '=',
    },
  }, {
    code: 'Backspace',
    layouts: {
      rus: 'delete',
      en: 'delete',
    },
  }],
  [{
    code: 'Tab',
    layouts: {
      rus: 'tab',
      en: 'tab',
    },
  }, {
    code: 'KeyQ',
    layouts: {
      rus: 'й',
      en: 'q',
    },
  }, {
    code: 'KeyW',
    layouts: {
      rus: 'ц',
      en: 'w',
    },
  }, {
    code: 'KeyE',
    layouts: {
      rus: 'у',
      en: 'e',
    },
  }, {
    code: 'KeyR',
    layouts: {
      rus: 'к',
      en: 'r',
    },
  }, {
    code: 'KeyT',
    layouts: {
      rus: 'е',
      en: 't',
    },
  }, {
    code: 'KeyY',
    layouts: {
      rus: 'н',
      en: 'y',
    },
  }, {
    code: 'KeyU',
    layouts: {
      rus: 'г',
      en: 'u',
    },
  }, {
    code: 'KeyI',
    layouts: {
      rus: 'ш',
      en: 'i',
    },
  }, {
    code: 'KeyO',
    layouts: {
      rus: 'щ',
      en: 'o',
    },
  }, {
    code: 'KeyP',
    layouts: {
      rus: 'з',
      en: 'p',
    },
  }, {
    code: 'BracketLeft',
    layouts: {
      rus: 'х',
      en: '[',
    },
  }, {
    code: 'BracketRight',
    layouts: {
      rus: 'ъ',
      en: ']',
    },
  }, {
    code: 'Backslash',
    layouts: {
      rus: '\\',
      en: '\\',
    },
  }],
  [{
    code: 'CapsLock',
    layouts: {
      rus: 'caps lock',
      en: 'caps lock',
    },
  }, {
    code: 'KeyA',
    layouts: {
      rus: 'ф',
      en: 'a',
    },
  }, {
    code: 'KeyS',
    layouts: {
      rus: 'ы',
      en: 's',
    },
  }, {
    code: 'KeyD',
    layouts: {
      rus: 'в',
      en: 'd',
    },
  }, {
    code: 'KeyF',
    layouts: {
      rus: 'а',
      en: 'f',
    },
  }, {
    code: 'KeyG',
    layouts: {
      rus: 'п',
      en: 'g',
    },
  }, {
    code: 'KeyH',
    layouts: {
      rus: 'р',
      en: 'h',
    },
  }, {
    code: 'KeyJ',
    layouts: {
      rus: 'о',
      en: 'j',
    },
  }, {
    code: 'KeyK',
    layouts: {
      rus: 'л',
      en: 'k',
    },
  }, {
    code: 'KeyL',
    layouts: {
      rus: 'д',
      en: 'l',
    },
  }, {
    code: 'Semicolon',
    layouts: {
      rus: 'ж',
      en: ';',
    },
  }, {
    code: 'Quote',
    layouts: {
      rus: 'э',
      en: '\'',
    },
  }, {
    code: 'Enter',
    layouts: {
      rus: 'return',
      en: 'return',
    },
  }],
  [{
    code: 'ShiftLeft',
    layouts: {
      rus: 'shift',
      en: 'shift',
    },
  }, {
    code: 'KeyZ',
    layouts: {
      rus: 'я',
      en: 'z',
    },
  }, {
    code: 'KeyX',
    layouts: {
      rus: 'ч',
      en: 'x',
    },
  }, {
    code: 'KeyC',
    layouts: {
      rus: 'с',
      en: 'c',
    },
  }, {
    code: 'KeyV',
    layouts: {
      rus: 'м',
      en: 'v',
    },
  }, {
    code: 'KeyB',
    layouts: {
      rus: 'и',
      en: 'b',
    },
  }, {
    code: 'KeyN',
    layouts: {
      rus: 'т',
      en: 'n',
    },
  }, {
    code: 'KeyM',
    layouts: {
      rus: 'ь',
      en: 'M',
    },
  }, {
    code: 'Comma',
    layouts: {
      rus: 'б',
      en: ',',
    },
  }, {
    code: 'Period',
    layouts: {
      rus: 'ю',
      en: '.',
    },
  }, {
    code: 'Slash',
    layouts: {
      rus: '.',
      en: '/',
    },
  }, {
    code: 'ShiftRight',
    layouts: {
      rus: 'shift',
      en: 'shift',
    },
  }],
  [{
    code: 'ControlLeft',
    layouts: {
      rus: '⌃',
      en: '⌃',
    },
  }, {
    code: 'AltLeft',
    layouts: {
      rus: '⌥',
      en: '⌥',
    },
  }, {
    code: 'MetaLeft',
    layouts: {
      rus: '⌘',
      en: '⌘',
    },
  }, {
    code: 'Space',
    layouts: {
      rus: 'space',
      en: 'space',
    },
  }, {
    code: 'MetaRight',
    layouts: {
      rus: '⌘',
      en: '⌘',
    },
  }, {
    code: 'AltRight',
    layouts: {
      rus: '⌥',
      en: '⌥',
    },
  }, {
    code: 'ArrowUp',
    layouts: {
      rus: '▲',
      en: '▲',
    },
  }, {
    code: 'ArrowLeft',
    layouts: {
      rus: '◀',
      en: '◀',
    },
  }, {
    code: 'ArrowDown',
    layouts: {
      rus: '▼',
      en: '▼',
    },
  }, {
    code: 'ArrowRight',
    layouts: {
      rus: '▶',
      en: '▶',
    },
  }],
];

console.log(keyLayout[0][0].layouts.en);

const body = document.querySelector('#body');

body.insertAdjacentHTML('beforeend', '<div class="container">'
  + '<h1 class="title">Virtual keyboard</h1>'
  + '<div class="container-text-keyboard">'
  + '<div class="text-area-container">'
  + '<textarea placeholder="Tap to start" class="input"></textarea>'
  + '</div>'
  + '<div class="keyboard-container">'
  + '<ul class="first-row rows">'
  + '<li>'
  + '<span class="caseDown">`</span>'
  + '</li>'
  + '<li>'
  + '<span class="">1</span>'
  + '</li>'
  + '<li>'
  + '<span class="">2</span>'
  + '</li>'
  + '<li>'
  + '<span class="">3</span>'
  + '</li>'
  + '<li>'
  + '<span class="">4</span>'
  + '</li>'
  + '<li>'
  + '<span class="">5</span>'
  + '</li>'
  + '<li>'
  + '<span class="">6</span>'
  + '</li>'
  + '<li>'
  + '<span class="">7</span>'
  + '</li>'
  + '<li>'
  + '<span class="">8</span>'
  + '</li>'
  + '<li>'
  + '<span class="">9</span>'
  + '</li>'
  + '<li>'
  + '<span class="">0</span>'
  + '</li>'
  + '<li>'
  + '<span class="">-</span>'
  + '</li>'
  + '<li>'
  + '<span class="">=</span>'
  + '</li>'
  + '<li>'
  + '<span class="">delete</span>'
  + '</li>'
  + '</ul>'
  + '<ul class="first-row rows">'
  + '<li>'
  + '<span class="caseDown">tab</span>'
  + '</li>'
  + '<li>'
  + '<span class="">q</span>'
  + '</li>'
  + '<li>'
  + '<span class="">w</span>'
  + '</li>'
  + '<li>'
  + '<span class="">e</span>'
  + '</li>'
  + '<li>'
  + '<span class="">r</span>'
  + '</li>'
  + '<li>'
  + '<span class="">t</span>'
  + '</li>'
  + '<li>'
  + '<span class="">y</span>'
  + '</li>'
  + '<li>'
  + '<span class="">u</span>'
  + '</li>'
  + '<li>'
  + '<span class="">i</span>'
  + '</li>'
  + '<li>'
  + '<span class="">o</span>'
  + '</li>'
  + '<li>'
  + '<span class="">[</span>'
  + '</li>'
  + '<li>'
  + '<span class="">]</span>'
  + '</li>'
  + '<li>'
  + '<span class="">&#x0002F;</span>'
  + '</li>'
  + '</ul>'
  + '</ul>'
  + '<ul class="first-row rows">'
  + '<li>'
  + '<span class="caseDown">caps lock</span>'
  + '</li>'
  + '<li>'
  + '<span class="">a</span>'
  + '</li>'
  + '<li>'
  + '<span class="">s</span>'
  + '</li>'
  + '<li>'
  + '<span class="">d</span>'
  + '</li>'
  + '<li>'
  + '<span class="">f</span>'
  + '</li>'
  + '<li>'
  + '<span class="">g</span>'
  + '</li>'
  + '<li>'
  + '<span class="">h</span>'
  + '</li>'
  + '<li>'
  + '<span class="">j</span>'
  + '</li>'
  + '<li>'
  + '<span class="">k</span>'
  + '</li>'
  + '<li>'
  + '<span class="">l</span>'
  + '</li>'
  + '<li>'
  + '<span class="">;</span>'
  + '</li>'
  + '<li>'
  + '<span class="">&#x00027;</span>'
  + '</li>'
  + '<li>'
  + '<span class="">return</span>'
  + '</li>'
  + '</ul>'
  + '<ul class="first-row rows">'
  + '<li>'
  + '<span class="caseDown">shift</span>'
  + '</li>'
  + '<li>'
  + '<span class="">z</span>'
  + '</li>'
  + '<li>'
  + '<span class="">x</span>'
  + '</li>'
  + '<li>'
  + '<span class="">c</span>'
  + '</li>'
  + '<li>'
  + '<span class="">c</span>'
  + '</li>'
  + '<li>'
  + '<span class="">v</span>'
  + '</li>'
  + '<li>'
  + '<span class="">b</span>'
  + '</li>'
  + '<li>'
  + '<span class="">n</span>'
  + '</li>'
  + '<li>'
  + '<span class="">m</span>'
  + '</li>'
  + '<li>'
  + '<span class="">,</span>'
  + '</li>'
  + '<li>'
  + '<span class="">.</span>'
  + '</li>'
  + '<li>'
  + '<span class="">/</span>'
  + '</li>'
  + '<li>'
  + '<span class="">shift</span>'
  + '</li>'
  + '</ul>'
  + '<ul class="first-row last-row rows">'
  + '<li>'
  + '<span class="">fn</span>'
  + '</li>'
  + '<li>'
  + '<span class="">⌃</span>'
  + '</li>'
  + '<li>'
  + '<span class="">⌥</span>'
  + '</li>'
  + '<li>'
  + '<span class="">⌘</span>'
  + '</li>'
  + '<li>'
  + '<span class="space"></span>'
  + '</li>'
  + '<li>'
  + '<span class="">⌘</span>'
  + '</li>'
  + '<li>'
  + '<span class="">⌥</span>'
  + '</li>'
  + '<div class="arrow-container">'
  + '<li class="caseUp">'
  + '<span>&#x25B4;</span>'
  + '</li>'
  + '<div class="arrow">'
  + '<li>'
  + '<span class="caseLeft">&#x25C2;</span>'
  + '</li>'
  + '<li>'
  + '<span class="caseDown">&#x25BE;</span>'
  + '</li>'
  + '<li>'
  + '<span class="caseRight">&#x25B8;</span>'
  + '</li>'
  + '</div>'
  + '</div>'
  + '</ul>'
  + '</div>'
  + '</div>'
  + '</div>'
  + '<div class="description">'
  + '<p>Keyboard was created for macOS</p>'
  + '<p>Switch between languages: command (⌘) + space</p>'
  + '</div>');

const keyboard = {
  elements: {
    textarea: null,
    main: null,
    keysContainer: null,
    keys: [],
  },

  properties: {
    value: '',
    capsLock: false,
  },

  init() {
    // Create main elements
    this.elements.main = document.createElement('div');
    this.elements.textarea = document.createElement('div');
    this.elements.textarea.insertAdjacentHTML('beforeend', '<div class="text-area-container">'
      + '<textarea placeholder="Tap to start" class="input"></textarea>'
      + '</div>');
    this.elements.keysContainer = document.createElement('div');

    // Setup main elements
    this.elements.main.appendChild(this.elements.textarea);
    this.elements.textarea.appendChild(this.elements.keysContainer);
    this.elements.keysContainer.appendChild(this.createKeys());

    this.elements.main.classList.add('container');
    this.elements.textarea.classList.add('container-text-keyboard');
    this.elements.keysContainer.classList.add('keyboard-container');

    this.elements.keys = this.elements.keysContainer.querySelectorAll('li');

    // Add to DOM
    this.elements.main.insertAdjacentHTML('afterbegin', '<h1>Virtual keyboard</h1>');
    document.body.appendChild(this.elements.main);
    body.insertAdjacentHTML('beforeend', '<div class="description">'
      + '<p>Keyboard was created for macOS</p>'
      + '<p>Switch between languages: command (⌘) + space</p>'
      + '</div>');

    // Automatically use keyboard for elements with .input

    document.querySelectorAll('.input').forEach((element) => {
      element.addEventListener('focus', () => {
        this.open(element.value, (currentValue) => {
          element.value = currentValue;
        });
      });
    });
  },
  createKeys() {
    const fragment = document.createDocumentFragment();

    keyLayout.forEach((firstArray) => {
      const ulElement = document.createElement('ul');

      ulElement.classList.add('rows');

      firstArray.forEach((element) => {
console.log(element)

        const liElement = document.createElement('li');

        if (element.layouts.en === '▲') {
          liElement.classList.add('top-arrow');
        }
        if (element.layouts.en === '◀') {
          liElement.classList.add('left-arrow');
        }
        if (element.layouts.en === '▼') {
          liElement.classList.add('bottom-arrow');
        }
        if (element.layouts.en === '▶') {
          liElement.classList.add('right-arrow');
        }

        if (element.layouts.en.length > 1) {
          liElement.classList.add('special');
        }

        switch (element.layouts.en) {
          // case 'delete':
          //   liElement.addEventListener('click', () => {
          //     this.properties.value = this.properties.value.substring(0, this.properties.value.length - 1);
          //   });
          //
          //   break;

          case 'enter':
            liElement.addEventListener('click', () => {
              this.properties.value += '\n';
            });

            break;

          case 'space':
            liElement.classList.add('space');

            liElement.addEventListener('click', () => {
              this.properties.value += ' ';
            });

            break;

          default:
            liElement.textContent = element.layouts.en.toLowerCase();

            liElement.classList.add(`${element.code}`);
            liElement.addEventListener('click', () => {
              this.properties.value += this.properties.capsLock ? element.layouts.en.toUpperCase() : element.layouts.en.toLowerCase();
            });

            break;
        }

        ulElement.appendChild(liElement);
      });
      fragment.appendChild(ulElement);
    });
    return fragment;
  },

  _toggleCapsLock() {
    this.properties.capsLock = !this.properties.capsLock;
    for (const key of this.elements.keys) {
      if (!key.classList.contains('special')) {
        key.textContent = this.properties.capsLock ? key.textContent.toUpperCase()
          : key.textContent.toLowerCase();
      }
    }
  },

  keyBehavior() {
    const capsLockElement = document.querySelector('.CapsLock');
    capsLockElement.addEventListener('click', () => {
      this._toggleCapsLock();
      capsLockElement.classList.toggle('capsLock-active', this.properties.capsLock);
    });

    for (const key of this.elements.keys) {
      key.addEventListener('click', (event) => {
        console.log('event.code', event.code, 'event.key', event.key);
      });
    }
  },

  handleKeyPress() {
    document.addEventListener('keypress', (event) => {
      const array = this.elements.keys;
      array.forEach((key) => {
        if (key.textContent === event.key) {
          key.classList.add('active');
        }
      });
    });
  },
};

window.addEventListener('DOMContentLoaded', () => {
  keyboard.init();
  keyboard.keyBehavior();
  keyboard.handleKeyPress();
});
